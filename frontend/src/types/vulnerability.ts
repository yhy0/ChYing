// 引入HttpTrafficItem
import type { HttpTrafficItem } from './http';

// 漏洞等级枚举
export enum VulnerabilityLevel {
  LOW = 'Low',
  MEDIUM = 'Medium', 
  HIGH = 'High',
  CRITICAL = 'Critical'
}

// 漏洞数据结构（对应后端VulnData）
export interface VulnerabilityData {
  // 后端字段名
  create_time?: string;
  vuln_type?: string;
  target?: string;
  ip?: string;
  method?: string;
  param?: string;
  payload?: string;
  curl_command?: string;
  description?: string;
  request?: string;
  header?: string;
  response?: string;
  
  // 前端兼容字段名
  createTime?: string;
  vulnType?: string;
  curlCommand?: string;
}

// 漏洞消息结构（对应后端VulMessage）
export interface VulnerabilityMessage {
  data_type?: string;    // 后端字段名
  dataType?: string;     // 前端兼容字段名
  vul_data?: VulnerabilityData;  // 后端字段名
  vulnData?: VulnerabilityData;  // 前端兼容字段名
  plugin: string;
  level: VulnerabilityLevel;
}

// 漏洞项目（用于表格显示）
export interface VulnerabilityItem extends HttpTrafficItem {
  vulnType: string;
  target: string;
  plugin: string;
  level: VulnerabilityLevel;
  createTime: string;
  description?: string;
  param?: string;
  payload?: string;
  curlCommand?: string;
  request?: string;
  response?: string;
}

// 漏洞统计
export interface VulnerabilityStatistics {
  total: number;
  critical: number;
  high: number;
  medium: number;
  low: number;
  byPlugin: Record<string, number>;
  byType: Record<string, number>;
  recent24h: number;
}

// 漏洞过滤器
export interface VulnerabilityFilter {
  searchKeyword: string;
  targetHost: string;
  vulnTypes: string[];
  plugins: string[];
  levels: VulnerabilityLevel[];
  dateRange: {
    start?: string;
    end?: string;
  };
}

// 漏洞窗口配置
export interface VulnerabilityWindowConfig {
  autoRefresh: boolean;
  refreshInterval: number; // 秒
  showStatistics: boolean;
  showFilters: boolean;
  pageSize: number;
} 